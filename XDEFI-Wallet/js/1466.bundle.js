!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c033b8d5-1afa-4222-a5f5-e98ae7f0c27d",e._sentryDebugIdIdentifier="sentry-dbid-c033b8d5-1afa-4222-a5f5-e98ae7f0c27d")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"28.2.2"},(self.webpackChunkxdefi_extension=self.webpackChunkxdefi_extension||[]).push([[1466],{21929:(e,t,r)=>{r.a(e,(async(e,a)=>{try{r.d(t,{Z:()=>j});var i=r(785893),s=r(667294),n=r(655902),o=r(308787),l=r(327754),d=r(876777),c=r(412252),m=r(34834),x=e([o]);o=(x.then?(await x)():x)[0];var u=Object.defineProperty,g=Object.defineProperties,p=Object.getOwnPropertyDescriptors,h=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,y=(e,t,r)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,v=(e,t)=>{for(var r in t||(t={}))b.call(t,r)&&y(e,r,t[r]);if(h)for(var r of h(t))f.call(t,r)&&y(e,r,t[r]);return e};const P=e=>{const t=Math.max(...e.datasets[0].data)/2,r=(0,l.F)({[d.$T.Dark]:d.wL.lime}),a=(0,l.F)({[d.$T.Dark]:d.wL.wineRed}),s={labels:new Array(e.datasets[0].data.length).fill(""),datasets:[(x=v({},e.datasets[0]),u={backgroundColor:e.datasets[0].data.map((e=>e<=t?r:a))},g(x,p(u)))]};var x,u;return e.datasets.forEach(((t,r)=>{e.datasets[r].backgroundColor=[d.wL.oceanBlue]})),(0,i.jsxs)(o.FlexBox,{flexDirection:"row",position:"relative",width:"fit-content",my:8,children:[(0,i.jsx)(o.FlexBox,{justifyContent:"center",alignItems:"center",paddingLeft:5,zIndex:1,children:(0,i.jsx)(c.Z,{children:"50%"})}),(0,i.jsx)(m.A,{}),(0,i.jsx)(m.s,{}),(0,i.jsx)(n.$Q,{data:s,options:{maintainAspectRatio:!1,responsive:!1,animation:!1,events:[],plugins:{legend:{display:!1}},scales:{x:{ticks:{display:!1},grid:{display:!1}},y:{ticks:{display:!1},grid:{display:!1}}}},style:{height:50,width:300,zIndex:1}})]})},j=(0,s.memo)(P,(function(e,t){return e.datasets[0].data[0]===t.datasets[0].data[0]}));a()}catch(e){a(e)}}))},80526:(e,t,r)=>{r.a(e,(async(e,a)=>{try{r.d(t,{Z:()=>C});var i=r(785893),s=r(244431),n=r(21723),o=r(379372),l=r(831352),d=r(739989),c=r(281672),m=r(561277),x=r(458038),u=r(394294),g=r(667294),p=r(230811),h=r(972819),b=r(427504),f=r(771341),y=r(308787),v=r(412252),P=r(505403),j=r(603874),w=r(585277),_=r(798368),F=e([n,o,c,h,y,P,w,_]);[n,o,c,h,y,P,w,_]=F.then?(await F)():F;const I=({txData:e,handleGasChange:t,handleNonceChange:r,disabled:a,chainId:s=l.yp.Ethereum})=>{const[n,d]=(0,g.useState)(),m=(0,c.fU)().getChainControllerById(l.yp.Ethereum),x=(0,g.useCallback)((()=>{return e=void 0,t=null,r=function*(){m.getFeeHistory().then((e=>{const{gasUsedRatio:t}=e;n&&n[0]===t[0]&&n.length||d(t)}))},new Promise(((a,i)=>{var s=e=>{try{o(r.next(e))}catch(e){i(e)}},n=e=>{try{o(r.throw(e))}catch(e){i(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(s,n);o((r=r.apply(e,t)).next())}));var e,t,r}),[]);return(0,g.useEffect)((()=>{if(s===j.y2){x();const e=setInterval(x,o.eK);return()=>{clearInterval(e)}}d(void 0)}),[x,s]),(0,i.jsx)(Z,{txData:e,history:n,chainId:s,disabled:a,handleNonceChange:r,handleGasChange:t})},Z=({txData:e,chainId:t,history:r,disabled:a,handleGasChange:l,handleNonceChange:j})=>{var F;const[I,Z]=(0,g.useState)(!1),C=(0,g.useCallback)((()=>Z(!I)),[I]),{getFiat:G}=(0,P.Z)(),[S,N]=(0,g.useState)(!1),[B,L]=(0,g.useState)(!1),{t:k}=(0,p.$G)("app"),O=(0,c.WG)(),E=(0,c.fU)(),T=(0,g.useMemo)((()=>E.getChainControllerById(t)),[E,t]).selfCast(),[D,M]=(0,g.useState)([]),[A,$]=(0,g.useState)();(0,g.useEffect)((()=>{B&&N(!1)}),[B]);const{addNotification:R}=(0,h.Z)(),W=(0,g.useCallback)((e=>{l(D[e].maxFeePerGas,D[e].maxPriorityFeePerGas,D[e].baseFee)}),[D,l]);(0,g.useEffect)((()=>{const e=()=>O.getEVMGasPrices(T).then((e=>(M&&M(e.sort(((e,t)=>e.maxFeePerGas>t.maxFeePerGas?-1:1))),e))).catch((e=>{var t,r;return d.Z.error("Error while fetching priority options",{error:e}),R({title:"ethereum_processing.errors.message",type:"error",message:null!=(r=null!=(t=null==e?void 0:e.reason)?t:null==e?void 0:e.message)?r:"There was an error while estimating gas for the txn, please set the gas manually"}),[]}));e().then((e=>{$&&$(Math.floor(e.length/2))}));const t=setInterval(e,o.eK);return()=>{clearInterval(t)}}),[]),(0,g.useEffect)((()=>{void 0===A||S||W(A)}),[S,W,A,D]);const z=(0,g.useCallback)(((r,a=e.gasLimit)=>G(t,r*a/o.uR,T.getConfig().tokenSymbol).toString()),[e.gasLimit,t,G]),J=(0,g.useCallback)(((t,r=e.gasLimit)=>{const a=t*r/o.uR;return(0,b.zr)(new s.BigNumber(a),T.getConfig().tokenSymbol)}),[e.gasLimit,t]),X=(0,g.useMemo)((()=>[{label:k("ethereum_processing.edit_label"),data:r}]),[r,k]);return(0,i.jsxs)(y.FlexBox,{mx:8,children:[(0,i.jsxs)(y.FlexBox,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",mb:16,children:[(0,i.jsxs)(y.FlexBox,{flexDirection:"row",alignItems:"center",children:[(0,i.jsx)(m.Z,{children:k("ethereum_processing.title")}),(0,i.jsx)(n.Z,{message:k("ethereum_processing.message"),dataTestId:"processingTimeInfoIcon"})]}),(0,i.jsx)(y.HoverButton,{Icon:(0,i.jsx)(f.dY,{}),onClick:C,label:k("evm_form_template.edit")}),I&&(0,i.jsx)(w.Z,{chainId:t,txData:e,open:I,onClose:C,processingPriorityOptions:D,history:X,handleFiatCalculation:z,handleFeeCalculation:J,handleCustomizedPriority:(t,r=!1)=>{var a;N(r);const i=D.findIndex((e=>e.value===(null==t?void 0:t.value)));L(0===i),-1!==i&&$(i),A&&l(t.maxFeePerGas,t.maxPriorityFeePerGas,null==(a=D[A])?void 0:a.baseFee,t.gasLimit),t.nonce!==e.nonce&&j(t.nonce)},customized:S})]}),(0,i.jsxs)(_.X2,{children:[(0,i.jsxs)(_.n$,{$on:B,pr:6,children:[(0,i.jsx)(_.HN,{$dance:B}),(0,i.jsxs)(y.FlexBox,{ml:8,flex:1,children:[(0,i.jsx)(u.Z,{whiteSpace:"nowrap",children:k("ethereum_processing.ape_mode")}),(0,i.jsx)(x.Z,{children:k("ethereum_processing.max_gas")})]}),(0,i.jsx)(y.Switch,{isWebApp:!0,dataTestId:"apeModeToggle",checked:B,onChange:()=>{a||($(B?Math.floor(D.length/2):0),L(!B))}})]}),(0,i.jsxs)(y.FlexBox,{alignItems:"flex-end",children:[(0,i.jsx)(m.Z,{children:S?k("general.unknown"):void 0!==A&&A>=0?null==(F=null==D?void 0:D[A])?void 0:F.processingTime:"..."}),(0,i.jsx)(v.Z,{children:k("general.estimate")})]})]})]})},C=(0,g.memo)(I);a()}catch(e){a(e)}}))},585277:(e,t,r)=>{r.a(e,(async(e,a)=>{try{r.d(t,{Z:()=>j});var i=r(785893),s=r(667294),n=r(21929),o=r(308787),l=r(17349),d=r(21723),c=r(626423),m=r(847001),x=r(458038),u=r(561277),g=r(394294),p=r(230811),h=r(542348),b=r(281672),f=r(831352),y=r(631283),v=e([n,o,l,d,b,y]);[n,o,l,d,b,y]=v.then?(await v)():v;const P=({txData:e,open:t,onClose:r,processingPriorityOptions:a,history:v,handleFeeCalculation:P,handleFiatCalculation:j,handleCustomizedPriority:w,customized:_,chainId:F})=>{var I;const{t:Z}=(0,p.$G)("app"),C=(0,b.fU)().getChainControllerById(F),[G,S]=(0,s.useState)(!1),[N,B]=(0,s.useState)(_),[{baseFee:L,maxPriorityFeePerGas:k,maxFeePerGas:O,value:E},T]=(0,s.useState)({baseFee:"0",maxPriorityFeePerGas:"0",maxFeePerGas:"0",value:0}),[D,M]=(0,s.useState)(0),[A,$]=(0,s.useState)(e.maxFeePerGas||0),[R,W]=(0,s.useState)(e.maxPriorityFeePerGas||0);(0,s.useEffect)((()=>{var e,t;if(N){T({baseFee:"N/A",maxPriorityFeePerGas:"N/A",maxFeePerGas:"N/A",value:0})}else if(!N&&a[D]){const r=a[D],i={baseFee:(null==r?void 0:r.baseFee.toFixed(0))||"0",maxPriorityFeePerGas:(null==(e=null==r?void 0:r.maxPriorityFeePerGas)?void 0:e.toFixed(2))||"0",maxFeePerGas:(null==(t=null==r?void 0:r.maxFeePerGas)?void 0:t.toFixed(2))||"0",value:r.value};T(i),B(!1)}}),[a,D,L]);const[z,J]=(0,s.useState)(e.gasLimit),[X,U]=(0,s.useState)(e.nonce);(0,s.useEffect)((()=>{a.length&&!N&&(W(Number(k)),$(Number(O)))}),[N,O,k,a.length]),(0,s.useEffect)((()=>{J(e.gasLimit)}),[e.gasLimit]),(0,s.useEffect)((()=>{U(e.nonce)}),[e.nonce]);const K=(0,s.useCallback)((()=>{w({maxFeePerGas:A,maxPriorityFeePerGas:R,gasLimit:z,nonce:X,value:N?void 0:E},N),r&&r()}),[A,R,z,w,N,X,r,E]),H=(0,s.useCallback)((e=>{const t=(0,c.Jr)(Number(e.target.value),0);U(t)}),[]),q=(0,s.useCallback)((e=>{const t=(0,c.Jr)(Number(e.target.value),1.5*m.Z.get("DEFAULT_GAS_LIMIT"));J(t)}),[]),V=(0,s.useCallback)((e=>{B(!0);const t=(0,c.Jr)(Number(e.target.value),0);W(t)}),[]),Y=(0,s.useCallback)((e=>{B(!0);let t=(0,c.Jr)(Number(e.target.value),1);c.hv[C.getConfig().network.chainId]===f.yp.Avalanche&&t<25&&(t=25),$(t)}),[]),Q=(0,s.useCallback)((()=>{r&&r()}),[r]),ee=()=>(0,i.jsx)(l.L,{label:{text:N?Z("general.n_a"):Z("edit_processing_priority_modal.chance",{chance:E})},show:G,setShow:e=>{S(e)},entries:a.map(((e,t)=>(0,i.jsx)(o.FlexBox,{px:N?16:0,justifyContent:"center",alignItems:"center",width:"100%",onClick:()=>{B(!1),$(e.maxFeePerGas),W(e.maxPriorityFeePerGas),M(t),S(!1)},children:(0,i.jsx)(x.Z,{children:Z("edit_processing_priority_modal.chance",{chance:e.value})})},e.value)))});return(0,i.jsx)(o.Dialog,{open:t,onClose:Q,onSubmit:K,"data-testid":"editTransactionCostPopup",title:Z("edit_processing_priority_modal.dialog_title"),children:(0,i.jsxs)(o.FlexBox,{p:8,maxHeight:"446px",children:[v&&v.length>0&&v[0].data&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.FlexBox,{children:[(0,i.jsxs)(y.DK,{children:[(0,i.jsx)(x.Z,{children:Z("edit_processing_priority_modal.history_text")}),(0,i.jsx)(d.Z,{placement:"bottom",dataTestId:"lastTransactionsInfoIcon",message:Z("edit_processing_priority_modal.history_info_helper")})]}),(0,i.jsx)(n.Z,{datasets:v})]}),(0,i.jsx)(y.d6,{})]}),(0,i.jsxs)(o.FlexBox,{py:12,children:[(0,i.jsxs)(y.X6,{children:[(0,i.jsx)(x.Z,{children:Z("edit_processing_priority_modal.estimate_the_next_block")}),(0,i.jsx)(o.FlexBox,{minWidth:125,children:(0,i.jsx)(ee,{})})]}),(0,i.jsxs)(o.FlexBox,{flexDirection:"row",justifyContent:"space-between",children:[(0,i.jsxs)(y.OL,{children:[(0,i.jsxs)(y.uR,{children:[(0,i.jsx)(o.FlexBox,{mr:4,children:(0,i.jsx)(u.Z,{children:L})}),(0,i.jsx)(x.Z,{children:"GWEI"})]}),(0,i.jsx)(y.__,{children:(0,i.jsx)(h.Z,{textAlign:"center",children:Z("edit_processing_priority_modal.base_fee")})}),(0,i.jsx)(d.Z,{placement:"right",dataTestId:"baseFeeInfoIcon",message:Z("edit_processing_priority_modal.minimum_gas_required")})]}),(0,i.jsxs)(y.OL,{children:[(0,i.jsxs)(y.uR,{children:[(0,i.jsx)(o.FlexBox,{mr:4,children:(0,i.jsx)(u.Z,{children:k})}),(0,i.jsx)(x.Z,{children:"GWEI"})]}),(0,i.jsx)(y.__,{children:(0,i.jsx)(h.Z,{textAlign:"center",children:Z("edit_processing_priority_modal.priority_tip")})}),(0,i.jsx)(d.Z,{dataTestId:"priorityTipInfoIcon",message:Z("edit_processing_priority_modal.priority_tip_helper")})]}),(0,i.jsxs)(y.OL,{children:[(0,i.jsxs)(y.uR,{children:[(0,i.jsx)(o.FlexBox,{mr:4,children:(0,i.jsx)(u.Z,{children:O})}),(0,i.jsx)(x.Z,{children:"GWEI"})]}),(0,i.jsx)(y.__,{children:(0,i.jsx)(h.Z,{textAlign:"center",children:Z("edit_processing_priority_modal.max_fee")})}),(0,i.jsx)(d.Z,{placement:"left",dataTestId:"maxFeeInfoIcon",message:Z("edit_processing_priority_modal.max_fee_helper")})]})]})]}),(0,i.jsx)(y.d6,{}),(0,i.jsxs)(y.t7,{children:[(0,i.jsx)(y.nv,{type:"number",value:N?A:O,onChange:Y,placeholder:"37",label:Z("edit_processing_priority_modal.max_fee_label"),min:1}),(0,i.jsx)(y.nv,{type:"number",value:N?R:k,onChange:V,placeholder:"5",label:Z("edit_processing_priority_modal.priority_tip_label"),min:0}),(0,i.jsx)(y.nv,{dataTestId:"nonceFld",type:"number",value:X,onChange:H,placeholder:"37",label:Z("edit_processing_priority_modal.nonce"),tipInfo:Z("edit_processing_priority_modal.nonce_tip_info"),tipPlacement:"top",min:0}),(0,i.jsx)(y.nv,{type:"number",dataTestId:"gasLimitFld",value:z,onChange:q,placeholder:"21000",label:Z("edit_processing_priority_modal.gas_limit_label"),tipInfo:Z("edit_processing_priority_modal.gas_limit_tip_info"),min:1})]}),(0,i.jsx)(y.d6,{}),(0,i.jsxs)(y.X2,{children:[(0,i.jsx)(y.DK,{children:(0,i.jsx)(x.Z,{children:Z("edit_processing_priority_modal.estimated_time")})}),N?"Unknown":null==(I=a[D])?void 0:I.processingTime]}),(0,i.jsx)(y.d6,{}),(0,i.jsxs)(y.X2,{children:[(0,i.jsx)(y.DK,{children:(0,i.jsx)(x.Z,{children:Z("edit_processing_priority_modal.expected_fee")})}),(0,i.jsx)(o.FiatAssetPair,{asset:P(Number(L)+Number(N?R:k),z),fiat:j(Number(L)+Number(N?R:k),z),alignItems:"flex-end"})]}),(0,i.jsx)(y.d6,{}),(0,i.jsxs)(y.X2,{pb:"16px",children:[(0,i.jsx)(y.DK,{children:(0,i.jsx)(g.Z,{children:Z("edit_processing_priority_modal.max_fee_you_will_pay")})}),(0,i.jsx)(o.FiatAssetPair,{asset:P(Number(N?A:O),z),fiat:j(Number(N?A:O),z),alignItems:"flex-end"})]})]})})},j=(0,s.memo)(P);a()}catch(e){a(e)}}))},461466:(e,t,r)=>{r.a(e,(async(e,a)=>{try{r.r(t),r.d(t,{default:()=>J});var i=r(785893),s=r(244431),n=r.n(s),o=r(646284),l=r(835534),d=r(379372),c=r(691438),m=r(847001),x=r(831352),u=r(834392),g=r(179826),p=r(177616),h=r(327194),b=r(739989),f=r(626423),y=r(281672),v=r(667294),P=r(230811),j=r(363119),w=r(25022),_=r(162318),F=r(184698),I=r(284755),Z=r(851892),C=r(308787),G=r(972819),S=r(519416),N=r(15964),B=r(901176),L=r(24296),k=r(123226),O=e([o,l,d,y,_,F,I,C,G,N,B,L]);[o,l,d,y,_,F,I,C,G,N,B,L]=O.then?(await O)():O;var E=Object.defineProperty,T=Object.defineProperties,D=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,R=(e,t,r)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,W=(e,t)=>{for(var r in t||(t={}))A.call(t,r)&&R(e,r,t[r]);if(M)for(var r of M(t))$.call(t,r)&&R(e,r,t[r]);return e},z=(e,t)=>T(e,D(t));const J=({transactionMsg:e})=>{var t;const{t:r}=(0,P.$G)("app"),[a,s]=(0,v.useState)({textSignature:""}),{onRequestPermission:O}=(0,F.gI)(),[E,T]=(0,v.useState)(!1),[D,M]=(0,v.useState)(),[A,$]=(0,v.useState)(!1),[R,J]=(0,v.useState)(),[X,U]=(0,v.useState)(),{addNotification:K}=(0,G.Z)(),H=S.browser.extension.getBackgroundPage().masterController,q=(0,y.WG)(),{dapps:V,chains:Y,masterKeys:Q}=H,{requireTxPassword:ee,activeWallet:te}=(0,j.v9)((e=>({requireTxPassword:e.settings.requireTxPassword,activeWallet:e.wallets.wallets[e.wallets.activeWalletId]}))),re=(0,v.useMemo)((()=>Y.getChainControllerById(e.chainId)),[e,Y]),ae=(0,v.useMemo)((()=>e.raw.params.length?e.raw.params[0]:e.raw.params),[e]),ie=(0,v.useMemo)((()=>{var t;return(null==(t=e.origin)?void 0:t.url)||""}),[null==(t=e.origin)?void 0:t.url]),se=(0,v.useMemo)((()=>{var e,t;const r=ae.amount||ae.value||"0";if(r){return(0,x.ym)(r)?p.formatUnits(null==(e=ae.amount)?void 0:e.amount,null==(t=ae.amount)?void 0:t.decimals).toString():p.formatUnits(h.O$.from(r).toString()).toString()}return"0"}),[ae.amount,ae.value]),ne=(0,v.useMemo)((()=>{let e=(null==ae?void 0:ae.gas)&&h.O$.from(null==ae?void 0:ae.gas).toNumber()||(null==ae?void 0:ae.gasLimit)&&h.O$.from(null==ae?void 0:ae.gasLimit).toNumber();return e<21e3&&(e=0),e}),[ae]),[oe,le]=(0,v.useState)(!1),[de,ce]=(0,v.useState)({baseFee:0,fromAddress:ae.from,toAddress:ae.to||ae.recipient,amount:h.O$.from(ae.amount||ae.value||"0").toString(),gasLimit:ne||1.5*m.Z.get("DEFAULT_GAS_LIMIT"),gasPrice:(null==ae?void 0:ae.gasPrice)?Number(null==ae?void 0:ae.gasPrice):void 0,maxFeePerGas:0,maxPriorityFeePerGas:0,nonce:-1,memo:(null==ae?void 0:ae.data)||"",feeRate:0,isToken:!1,decimals:0,address:""}),{fee:me,setFee:xe,feeRate:ue}=(0,B.g)({chain:re,params:ae,gasPrice:de.gasPrice,gasLimit:de.gasLimit}),ge=(0,L.z)({chain:re,params:ae});(0,v.useEffect)((()=>{var e;X||d.xP.getABI(ae.to).then((e=>{var t,r;Array.isArray(null==(t=null==e?void 0:e.result[0])?void 0:t.ABI)?U(JSON.parse((null==(r=null==e?void 0:e.result[0])?void 0:r.ABI)||[])):U([])})).catch((e=>{b.Z.error({transactionMsg:"getABI error: ",err:e}),U([]),s({textSignature:""})})),""!==a.textSignature&&d.xP.getSignatures((null==(e=null==ae?void 0:ae.data)?void 0:e.slice(0,10))||"").then((e=>{var t,r;s({textSignature:null==(r=null==(t=e.results)?void 0:t[0])?void 0:r.text_signature})})).catch((e=>{b.Z.error({transactionMsg:"getSignatures error",err:e})}))}),[X,a.textSignature,re,null==ae?void 0:ae.data,ae.to,H,ae.from,de.fromAddress,de.toAddress,de.amount,de.memo]),(0,v.useEffect)((()=>{re.getTransactionCount(ae.from||"").then((e=>{b.Z.info({txCount:e}),de.nonce&&-1!==de.nonce||ce((t=>z(W({},t),{nonce:e})))})).catch((e=>{b.Z.error({err:e}),K({title:r("alert.transaction.errors.transaction.title"),type:"error",message:r((0,Z.ZP)(e,re.getType()))})}))}),[]);const pe=(0,v.useCallback)((e=>{ce((t=>z(W({},t),{gasLimit:e})))}),[]);(0,v.useEffect)((()=>{J(d.xP.decryptParams(a,X,ae)),q.getEVMGasPrice&&q.getEVMGasPrice(re).then((e=>{if(b.Z.info({feeData:e}),re.support(c.B.Eip1559)){const{maxFeePerGas:t,maxPriorityFeePerGas:r}=e;ce((e=>z(W({},e),{maxPriorityFeePerGas:r,maxFeePerGas:t})))}else{const t=Number(e.average.toFixed(u.uO));ce((e=>z(W({},e),{gasPrice:t})))}})),ne||re.estimateTx(de.fromAddress,de.toAddress,de.amount,null==ae?void 0:ae.data).then((e=>{b.Z.info("estimateTx:",e),ce((t=>z(W({},t),{gasLimit:null!=ne?ne:Math.round(e.toNumber()*m.Z.get("FACTOR_ESTIMATE"))})))})).catch((e=>{b.Z.error({error:e})}))}),[q]);const he=(0,v.useCallback)((t=>{return a=void 0,i=null,s=function*(){if(ee&&!t)return;if(A)return void le(!0);b.Z.debug({method:"handleApprove"}),b.Z.debug({msg:"preMP",requireTxPassword:ee});const a=t||Q.masterPassword;if(a){T(!0);try{const t=l.Z.getWalletIdWithMessage(e);let r={gasPrice:de.gasPrice||void 0,gasLimit:de.gasLimit||void 0,maxFeePerGas:de.maxFeePerGas||void 0,maxPriorityFeePerGas:de.maxPriorityFeePerGas||void 0,nonce:de.nonce};re.getType()!==c.J.Bitcoin&&re.getType()!==c.J.Dogecoin||ue&&(r={feeRate:ue}),yield H.approveDappsTransaction(e,t,w.GG.Transaction,{walletPassword:a},r),V.removeMessageById(e.xdefiId)}catch(e){if("TransportOpenUserCancelled"===(null==e?void 0:e.name))return K({title:r("alert.transaction.hardware.error.main.title"),type:"error",message:r("alert.transaction.hardware.error.main.message")}),O();if(null==e?void 0:e.message.includes("Invalid password"))return K({title:r("alert.wallet.password.error.incorrect.title"),type:"error",message:r("alert.wallet.password.error.incorrect.messages.try_again")});const t=(0,Z.sJ)(e);b.Z.error("Transfer error",{error:t}),K({title:r("alert.transaction.errors.transfer.title"),type:"error",message:r((0,Z.ZP)(t,c.J.Evm))}),b.Z.error({transactionMsg:"Error in message approval",e})}finally{T(!1)}b.Z.info("end handleApprove")}},new Promise(((e,t)=>{var r=e=>{try{o(s.next(e))}catch(e){t(e)}},n=e=>{try{o(s.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,n);o((s=s.apply(a,i)).next())}));var a,i,s}),[te,re,H,V,ue,A,Q.masterPassword,O,ee,e,de,r]),be=(0,v.useCallback)((()=>{b.Z.info("handleReject ",e),S.browser.runtime.sendMessage(null,{xdefiId:e.xdefiId,raw:{id:e.xdefiId,error:g.ethErrors.provider.userRejectedRequest()}}),V.removeMessageById(e.xdefiId),window.close()}),[V,e]),fe=(0,v.useCallback)((()=>{le(!1),$(!1)}),[]),ye=(0,v.useCallback)(((e,t,r,a)=>{if(ce((a=>z(W({},a),{maxPriorityFeePerGas:t,maxFeePerGas:e,baseFee:r}))),a&&pe(a),t&&e&&de.gasLimit){const t=e*de.gasLimit/d.uR;xe(new(n())(t))}}),[xe,de.gasLimit,pe]),ve=(0,v.useCallback)((()=>{if(!D||!de.gasPrice)return;const e=Object.keys(D||{}).sort(f.j2),t=10*Number(de.gasPrice),r=e.findIndex(((r,a)=>Number(e[a])<=t&&(a===e.length-1||t<Number(e[a+1]))));return-1===r?D[e[0]]:r===e.length-1?D[e[e.length-1]]:(D[e[r]]*(Number(e[r+1])-t)+D[e[r+1]]*(t-Number(e[r])))/(Number(e[r+1])-Number(e[r]))}),[D,de.gasPrice]),Pe=(0,v.useMemo)((()=>re instanceof d.xP&&(re.support(c.B.Eip1559)?de.nonce<0||![de.gasLimit,de.nonce,de.maxPriorityFeePerGas,de.maxFeePerGas,null==de?void 0:de.baseFee].every((e=>Number.isFinite(Number.parseInt(`${e}`)))):de.nonce<0||![de.gasPrice,de.gasLimit,de.nonce].every((e=>Number.isFinite(Number.parseInt(`${e}`))))||!D)),[re,D,null==de?void 0:de.baseFee,de.gasLimit,de.gasPrice,de.maxFeePerGas,de.maxPriorityFeePerGas,de.nonce]),{openDialog:je,onCloseDialog:we,handleConfirm:_e}=(0,o.useConfirmDialog)(he);return(0,i.jsx)(k.k,{body:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.ConfirmDialog,{open:je,onClose:we,onSubmit:_e}),(0,i.jsx)(C.ScrollBars,{autoHide:!0,children:(0,i.jsxs)(C.FlexBox,{height:"100%",children:[(0,i.jsx)(_.Z,{url:ie,displayAmount:se,action:"approve",from:ae.from,to:ae.to||ae.recipient,assetSymbol:ge,defaultIcon:re.getConfig().image,isTokenTransfer:!1,chainId:re.getId(),fee:Number(me)}),(0,i.jsx)(N.Z,{sigInfo:R,params:ae,txData:de,setNonce:e=>{ce((t=>z(W({},t),{nonce:e})))},setGasPrice:e=>{ce((t=>z(W({},t),{gasPrice:e})))},setGasLimit:pe,chainId:re.getId(),handleGasChange:ye,setGasPriceWarning:$,gasPriceWarning:A,handleConfirm:fe,setShowGweiMaximum:le,showGweiMaximum:oe,fee:me,gasEstimateError:!1,disabled:Pe,estimateTimeFromGas:ve,setGasPriceRange:M}),(0,i.jsx)(I.Z,{handleConfirm:()=>_e(),fee:Number(me),baseFee:null==de?void 0:de.baseFee,chainId:re.getId(),assetSymbol:ge,errors:{},handleReject:be,loading:E||Pe,maxPriorityFeePerGas:de.maxPriorityFeePerGas,gasLimit:de.gasLimit,selectedWallet:te})]})})]})})};a()}catch(e){a(e)}}))},15964:(e,t,r)=>{r.a(e,(async(e,a)=>{try{r.d(t,{Z:()=>k});var i=r(785893),s=r(244431),n=r(646284),o=r(206508),l=r(80526),d=r(281672),c=r(496486),m=r(59854),x=r.n(m),u=r(667294),g=r(230811),p=r(977314),h=r(691438),b=r(739989),f=r(626423),y=r(308787),v=r(458038),P=r(412252),j=r(744141),w=e([n,o,l,d,y,j]);[n,o,l,d,y,j]=w.then?(await w)():w;var _=Object.defineProperty,F=Object.defineProperties,I=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable,S=(e,t,r)=>t in e?_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,N=(e,t)=>{for(var r in t||(t={}))C.call(t,r)&&S(e,r,t[r]);if(Z)for(var r of Z(t))G.call(t,r)&&S(e,r,t[r]);return e};const B=()=>(0,i.jsx)(y.FlexBox,{justifyContent:"center",flexDirection:"row",children:(0,i.jsx)(n.Loader,{})}),L=({txData:e,sigInfo:t,params:r,setNonce:a,setGasPrice:m,setGasLimit:w,chainId:_,setGasPriceWarning:Z,gasPriceWarning:C,showGweiMaximum:G,setShowGweiMaximum:S,handleConfirm:L,fee:k,disabled:O,gasEstimateError:E,handleGasChange:T,estimateTimeFromGas:D,setGasPriceRange:M})=>{var A;const[$,R]=(0,u.useState)(0),{t:W}=(0,g.$G)("app"),z=(0,d.WG)(),J=(0,d.fU)(),X=(0,u.useMemo)((()=>J.getChainControllerById(_)),[_,J]).selfCast(),[U,K]=(0,u.useState)(.2),[H,q]=(0,u.useState)(.1),[V,Y]=(0,u.useState)(D());(0,u.useEffect)((()=>{Y(D())}),[D]),(0,u.useEffect)((()=>{z.getEVMGasPrice&&z.getEVMGasPrice(X).then((e=>{if(X.support(h.B.Eip1559))T(e.maxFeePerGas,e.maxPriorityFeePerGas,e.baseFee);else{M(e.gasPriceRange);const t=Object.keys((null==e?void 0:e.gasPriceRange)||{}).sort(f.j2);t&&(K(x()(Number((0,c.max)(t)),2)),Number(null==e?void 0:e.safeLow)<1?q(Number(null==e?void 0:e.safeLow)):q(x()(Number((null==e?void 0:e.safeLow)||0))))}}))}),[_,z]),(0,u.useEffect)((()=>{(null==e?void 0:e.gasPrice)&&(e.gasPrice>U?(b.Z.debug("setGasPrice(maxGasPrice)"+U),m(U)):e.gasPrice<H&&(b.Z.debug("setGasPrice(minGasPrice)"+H),m(H)))}),[U,H,m,e.gasPrice]);const Q=(0,u.useMemo)((()=>Number((0,f.Jr)(Number(H),1.1).toFixed(3))),[H]),ee=(0,u.useMemo)((()=>Number((0,f.Jr)(Number(U),10).toFixed(3))),[U]),te=(0,u.useMemo)((()=>Number((0,f.Jr)(Number(null==e?void 0:e.gasPrice),1).toFixed(3))),[e.gasPrice]);return(0,i.jsxs)(j.Zb,{children:[G&&(0,i.jsx)(n.MaxGweiPopup,{open:G,currentGasPrice:String(e.gasPrice),maxGasPrice:U,maxFee:new s.BigNumber(U).multipliedBy(new s.BigNumber(e.gasLimit)).dividedBy(1e9).toNumber(),currentFee:k,onClose:()=>S(!1),onSubmit:L}),(0,i.jsx)(y.FlexBox,{children:(0,i.jsxs)(y.Tabs,{children:[(0,i.jsx)(y.Tab,{title:W("evm_signing.details_tab"),handleClick:()=>R(0)}),(0,i.jsx)(y.Tab,{title:W("evm_signing.data_tab"),handleClick:()=>R(1)})]})}),(0,i.jsxs)(p.ZP,{axis:"x",index:$,onChangeIndex:e=>R(e),children:[(0,i.jsx)(j.x4,{value:0,children:X.support(h.B.Eip1559)?(0,i.jsx)(i.Fragment,{children:O?(0,i.jsx)(B,{}):(0,i.jsx)(l.Z,{txData:(re=N({},e),ae={nonce:(0,f.Jr)(Number(null==e?void 0:e.nonce),-1)},F(re,I(ae))),handleGasChange:T,handleNonceChange:a,disabled:O||!1,chainId:_})}):(0,i.jsx)(i.Fragment,{children:O?(0,i.jsx)(B,{}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(j.c0,{children:[(0,i.jsx)(o.pX,{nonce:(0,f.Jr)(Number(null==e?void 0:e.nonce),0),setNonce:a,disabled:O}),(0,i.jsx)(o.J8,{gasPrice:te,gasLimit:e.gasLimit,handleGasLimitChange:w,setGasPrice:e=>{(e>U||e<H)&&!C&&Z(!0),m(e)},gasEstimateError:E,disabled:O,minGasPrice:Q,maxGasPrice:ee})]}),!E&&(0,i.jsx)(o.jh,{slider:!0,timeValue:V,min:Q,max:ee,gasPrice:te,setGasPrice:m,disabled:O})]})})}),(0,i.jsx)(j.x4,{value:1,children:(0,i.jsxs)(j.No,{children:[(0,i.jsxs)(j.X2,{children:[(0,i.jsx)(P.Z,{children:W("evm_signing.function_type")}),(0,i.jsx)(v.Z,{children:(null==t?void 0:t.type)||W("evm_signing.unknown")})]}),(0,i.jsx)(y.DashLine,{}),!!(null==t?void 0:t.params.length)&&(0,i.jsxs)(j.W7,{children:[(0,i.jsx)(P.Z,{children:W("evm_signing.parameters")}),(0,i.jsx)(y.Table,{keys:["type","name","data"],data:null==t?void 0:t.params}),(0,i.jsx)(y.DashLine,{})]}),(0,i.jsxs)(j.X2,{children:[(0,i.jsx)(P.Z,{children:W("evm_signing.data_hex")}),(0,i.jsx)(v.Z,{children:W("evm_signing.bytes",{bytes:((null==(A=null==r?void 0:r.data)?void 0:A.length)-2)/2})})]}),(0,i.jsx)(j.aZ,{children:(0,i.jsx)(P.Z,{children:r.data})})]})})]})]});var re,ae},k=(0,u.memo)(L);a()}catch(e){a(e)}}))},139082:(e,t,r)=>{r.d(t,{Z:()=>c});var a=r(785893),i=r(15145),s=Object.defineProperty,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,d=(e,t,r)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const c=e=>{var t=e,{dataTestId:r,color:s}=t,c=((e,t)=>{var r={};for(var a in e)o.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&n)for(var a of n(e))t.indexOf(a)<0&&l.call(e,a)&&(r[a]=e[a]);return r})(t,["dataTestId","color"]);return(0,a.jsx)(i.Z,((e,t)=>{for(var r in t||(t={}))o.call(t,r)&&d(e,r,t[r]);if(n)for(var r of n(t))l.call(t,r)&&d(e,r,t[r]);return e})({fontSize:10,lineHeight:"16px",color:s,fontWeight:500,"data-testid":r},c))}},542348:(e,t,r)=>{r.d(t,{Z:()=>m});var a=r(785893),i=r(876777),s=r(139082),n=Object.defineProperty,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,c=(e,t,r)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const m=e=>(0,a.jsx)(s.Z,((e,t)=>{for(var r in t||(t={}))l.call(t,r)&&c(e,r,t[r]);if(o)for(var r of o(t))d.call(t,r)&&c(e,r,t[r]);return e})({color:i.wL.darkGrey},e))},34834:(e,t,r)=>{r.d(t,{A:()=>i,s:()=>s});var a=r(818117);const i=a.ZP.div`
  background-color: ${({theme:{palette:e}})=>e.container.section};
  height: 100%;
  width: 100%;
  position: absolute;
`,s=a.ZP.div`
  height: 2px;
  top: 24px;
  width: calc(100% - 30px);
  position: absolute;
  border-top: 1px dashed
    ${({theme:{palette:e}})=>e.container.divider};
  margin-left: 30px;
`},798368:(e,t,r)=>{r.a(e,(async(e,a)=>{try{r.d(t,{HN:()=>c,X2:()=>x,n$:()=>m});var i=r(818117),s=r(771341),n=r(308787),o=r(876777),l=r(233884),d=e([n]);n=(d.then?(await d)():d)[0];const c=(0,i.ZP)(s.HN)`
  animation: ${({$dance:e})=>e?l.OK.A3:null};
`,m=(0,i.ZP)(n.FlexBox).attrs({flexDirection:"row",alignItems:"center"})`
  background: ${({theme:e,$on:t})=>t?o.wL.oceanBlue:e.palette.container.background};
  border: 1px solid
    ${({theme:e,$on:t})=>t?o.wL.deepSea:e.palette.base.contrary};
  box-sizing: border-box;
  border-radius: 8px;
  height: 44px;
  padding-left: 16px;
`,x=(0,i.ZP)(n.FlexBox).attrs({flexDirection:"row",justifyContent:"space-between",alignItems:"center"})`
  padding-bottom: 15px;
  border-bottom: 1px dashed ${o.wL.black};
`;a()}catch(e){a(e)}}))},631283:(e,t,r)=>{r.a(e,(async(e,a)=>{try{r.d(t,{DK:()=>u,OL:()=>m,X2:()=>d,X6:()=>p,__:()=>h,d6:()=>b,nv:()=>x,t7:()=>c,uR:()=>g});var i=r(818117),s=r(308787),n=r(771341),o=r(876777),l=e([s]);s=(l.then?(await l)():l)[0];const d=(0,i.ZP)(s.FlexBox).attrs({flexDirection:"row",justifyContent:"space-between",alignItems:"center",textAlign:"center",py:"16px"})`
  height: ${({height:e})=>e?`${e}px;`:"50px;"};
  color: ${({theme:{palette:e}})=>e.label.default};
`,c=(0,i.ZP)(s.FlexBox).attrs({flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"})``,m=(0,i.ZP)(s.FlexBox).attrs({justifyContent:"center",alignItems:"center"})`
  width: 102px;
  height: 77px;
  background: ${o.wL.charcoal};
  box-shadow: 0 0 2px rgba(0, 0, 0, 0.25);
  border-radius: 7px;
`,x=((0,i.ZP)(s.BaseButton).attrs({type:"button",fullWidth:!0})`
  margin: 0 10px;
`,(0,i.ZP)(s.InputField)`
  > div:first-child {
    line-height: 20px;
    font-size: 12px !important;
    margin-top: 3px;
  }

  > div:nth-child(2) {
    box-shadow: none;
    border: 0;
    outline: none;
    margin: 5px 0;
    line-height: 10px;
    height: 32px;
    width: 140px;

    > input {
      padding: 0 12px;
      font-weight: 400;
      font-size: 12px;
      line-height: 15px;
      letter-spacing: 0.35px;
      opacity: 1;
      width: 100%;

      &::placeholder {
        font-size: 12px;
        font-weight: 300;
      }
    }
  }
`),u=(i.ZP.div`
  display: flex;
  padding: 0 10px;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  text-align: center;
  height: 32px;
`,(0,i.ZP)(s.FlexBox).attrs({flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start"})``),g=(0,i.ZP)(s.FlexBox).attrs({flexDirection:"row",alignItems:"center"})``,p=(0,i.ZP)(s.FlexBox).attrs({justifyContent:"space-between",flexDirection:"row",alignItems:"center"})`
  padding-bottom: 10px;
`,h=i.ZP.div`
  padding-bottom: 4px;
  text-transform: uppercase;
`,b=((0,i.ZP)(n.Tw)`
  cursor: pointer;
`,(0,i.ZP)(s.DashLine)`
  background-image: linear-gradient(
    to right,
    black 25%,
    ${({theme:{palette:e}})=>e.container.section} 25%
  );
`);(0,i.ZP)(s.FlexBox).attrs({px:4})`
  width: 100%;
`,(0,i.ZP)(s.FlexBox)`
  width: 100%;
`;a()}catch(e){a(e)}}))},744141:(e,t,r)=>{r.a(e,(async(e,a)=>{try{r.d(t,{No:()=>m,W7:()=>x,X2:()=>u,Zb:()=>l,aZ:()=>g,c0:()=>c,x4:()=>d});var i=r(308787),s=r(876777),n=r(818117),o=e([i]);i=(o.then?(await o)():o)[0];const l=(0,n.ZP)(i.Card)`
  box-shadow: none;
  border-bottom: 1px solid ${s.wL.black};
`,d=(0,n.ZP)(i.FlexBox)`
  overflow-x: hidden;
  padding: 20px 10px;
`,c=n.ZP.div`
  display: grid;
  grid-auto-flow: column;
  grid-gap: 8px;
  padding-top: 20px;
  padding-bottom: 37px;
  align-items: end;
`,m=(0,n.ZP)(i.ScrollingContainer)`
  width: 100% !important;
  height: 162px !important;
`,x=(0,n.ZP)(i.FlexBox).attrs({alignItems:"flex-start"})`
  box-sizing: border-box;
`,u=(0,n.ZP)(i.FlexBox).attrs({alignItems:"center",justifyContent:"space-between",flexDirection:"row"})`
  height: 50px;
  padding: 0 10px;
  box-sizing: border-box;
`,g=n.ZP.div`
  width: 100%;
  box-sizing: border-box;
  padding: 0 10px;
  word-break: break-all;
  padding-bottom: 15px;
`;a()}catch(e){a(e)}}))}}]);
//# sourceMappingURL=1466.bundle.js.map